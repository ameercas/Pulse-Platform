!function(e){function t(e){return e.replace(/\b((http|https):\/\/\S+)/g,'<a href="$1" target="_blank">$1</a>')}function s(e){var t=new Date(e),s=new Date-t;if(1e4>=s)return"Just now";var a=null,i={millisecond:1,second:1e3,minute:60,hour:60,day:24,month:30,year:12};for(var n in i){if(s<i[n])break;a=n,s/=i[n]}return s=Math.floor(s),1!==s&&(a+="s"),[s,a,"ago"].join(" ")}e.fn.facebookWall=function(a){if(a=a||{},!a.id)throw new Error("You need to provide an user/page id!");if(!a.access_token)throw new Error("You need to provide an access token!");a=e.extend({limit:15},a);var i="https://graph.facebook.com/"+a.id+"/?fields=name,picture&access_token="+a.access_token+"&callback=?",n="https://graph.facebook.com/"+a.id+"/posts/?fields=name,picture,from,created_time,type,message,link,likes.summary(true),comments.summary(true)&access_token="+a.access_token+"&callback=?&date_format=U&limit="+a.limit,o=this;return e.when(e.getJSON(i),e.getJSON(n)).done(function(a,i){var n={user:a[0],posts:[]};e.each(i[0].data,function(){if("link"!=this.type&&"status"!=this.type||!this.message)return!0;this.from.picture=n.user.picture.data.url,this.created_time=s(1e3*this.created_time),this.message=t(this.message);var e=0;"undefined"!=typeof this.comments&&(e=this.comments.data.length),this.comment_count=e;var a=0;"undefined"!=typeof this.likes&&(a=this.likes.data.length),this.likes_count=a,n.posts.push(this)}),e("#headingTpl").tmpl(n.user).appendTo(o),e("#feedTpl").tmpl(n.posts).appendTo(o)}),this}}(jQuery);