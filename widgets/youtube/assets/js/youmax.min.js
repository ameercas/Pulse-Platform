var youmax_global_options={};!function(a){var o=function(a){var o,i;a=a.replace("PT","").replace("S","").replace("M",":").replace("H",":");var e=a.split(":");i=e[0];for(var l=1;l<e.length;l++)o=e[l],""==o?i+=":00":(o=parseInt(o,10),i+=10>o?":0"+o:":"+o);return 1==e.length&&(i="0:"+i),i},i=function(a){if(null==a||""==a||"undefined"==a)return"?";var o=a.toString().split("T")[0].split("-"),i=new Date,e=i.getFullYear(),l=parseInt(o[0],10),t=i.getMonth(),s=parseInt(o[1],10),u=t+12*e-(s+12*l);if(1>=u)return"1 month";if(12>u)return u+" months";var n=Math.floor(u/12);return 1>=n?"1 year":12>n?n+" years":void 0},e=function(a){if(null==a||""==a||"undefined"==a)return"?";a=a.toString();for(var o="",i=0,e=a.length;e>=0;e--)o+=a.charAt(e),3==i&&e>0?(i=1,o+=","):i++;return o.split("").reverse().join("")},l=function(){youmaxWidgetWidth=a("#youmax").width(),a("#youmax").append('<div id="youmax-header"><div id="youmax-stat-holder"></div></div>'),a("#youmax").append(""==youmax_global_options.youTubePlaylistURL?'<div id="youmax-tabs"><span id="uploads_" class="youmax-tab">Uploads</span><span id="playlists_" class="youmax-tab">Playlists</span></div>':'<div id="youmax-tabs"><span id="featured_" class="youmax-tab">Featured</span><span id="uploads_" class="youmax-tab">Uploads</span><span id="playlists_" class="youmax-tab">Playlists</span></div>'),a("#youmax").append('<div id="youmax-encloser"><iframe id="youmax-video" width="'+(youmaxWidgetWidth-2)+'" height="'+youmaxWidgetWidth/youmax_global_options.youtubeVideoAspectRatio+'" src="" frameborder="0" allowfullscreen></iframe><div id="youmax-video-list-div"></div><div id="youmax-load-more-div">LOAD MORE</div></div>'),a("#youmax-video").hide(),a("#youmax").append('<div id="youmax-lightbox"><div style="width:100%; position:absolute; top:20%;"><iframe id="youmax-video-lightbox" width="640" height="360" src="" frameborder="0" allowfullscreen></iframe></div></div>'),a("#youmax-lightbox").hide()},t=function(o){a.ajax({url:o,type:"GET",async:!0,cache:!0,dataType:"json",success:function(a){youmaxChannelId=a.items[0].id,u(youmaxChannelId)},error:function(a){console.log(a)},beforeSend:n})},u=function(o){var i=youmax_global_options.url+"/api/v1/widget/get/youtube/getFeed?call=profile&channelId="+o+"&sl="+youmax_global_options.sl;a.ajax({url:i,type:"GET",async:!0,cache:!0,dataType:"json",success:function(a){m(a)},error:function(a){console.log(a)},beforeSend:n})},n=function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/j-son;charset=UTF-8")},d=function(){youmax_global_options.youmaxItemCount=0,a("#youmax-video-list-div").empty(),a("#youmax-video").hide(),a("#youmax-video").attr("src",""),a("#youmax-video-list-div").append('<div style="text-align:center; height:200px; font:14px Calibri;"><br><br><br><br><br><br>loading...</div>')},y=function(){youTubePlaylistURL=youmax_global_options.youTubePlaylistURL,console.log("inside init featured - "+youTubePlaylistURL),null!=youTubePlaylistURL&&-1!=youTubePlaylistURL.indexOf("youtube.com/playlist?list=")&&(youmaxFeaturedPlaylistId=youTubePlaylistURL.substring(youTubePlaylistURL.indexOf("?list=")+6),youmax_global_options.youmaxFeaturedPlaylistId=youmaxFeaturedPlaylistId)},m=function(o){console.log("showInfo"),console.log(o);var i=o.items[0],e=i.id,l=i.snippet.title,t=i.snippet.thumbnails["default"].url,s=(i.statistics.subscriberCount,i.statistics.viewCount,i.contentDetails.relatedPlaylists.uploads);a("#youmax-header").append('<img id="youmax-header-logo" src="'+t+'"/>'+l),a("#youmax-header").append('&nbsp;&nbsp;&nbsp;&nbsp;<div class="youmax-subscribe"><div class="g-ytsubscribe" data-channelid="'+e+'" data-layout="default" data-count="default"></div></div>'),p(),a("#youmax-tabs").find("span[id^=uploads_]").attr("id","uploads_"+s),youmaxDefaultTab=youmax_global_options.youmaxDefaultTab,"undefined"==typeof youmaxDefaultTab||null==youmaxDefaultTab||""==youmaxDefaultTab||"undefined"==youmaxDefaultTab?a("#youmax-tabs span[id^=featured_]").click():"UPLOADS"==youmaxDefaultTab.toUpperCase()||"UPLOAD"==youmaxDefaultTab.toUpperCase()?a("#youmax-tabs span[id^=uploads_]").click():"PLAYLISTS"==youmaxDefaultTab.toUpperCase()||"PLAYLIST"==youmaxDefaultTab.toUpperCase()?a("#youmax-tabs span[id^=playlists_]").click():("FEATURED"==youmaxDefaultTab.toUpperCase()||"FEATURED"==youmaxDefaultTab.toUpperCase())&&a("#youmax-tabs span[id^=featured_]").click()},p=function(){a.ajaxSetup({cache:!0}),a.getScript("https://apis.google.com/js/platform.js").done(function(){}).fail(function(){})},r=function(o,e){console.log(o),e||a("#youmax-video-list-div").empty();var l=o.nextPageToken,t=a("#youmax-load-more-div");null!=l&&"undefined"!=l&&""!=l?t.data("nextpagetoken",l):t.data("nextpagetoken",""),youmaxColumns=youmax_global_options.youmaxColumns;for(var s=o.items,u=[],n=0,y=0;y<s.length;y++)playListId=s[y].id,playlistSize=s[y].contentDetails.itemCount,playlistSize<=0?n++:(u.push(playListId),playlistTitle=s[y].snippet.title,playlistUploaded=s[y].snippet.publishedAt,playlistThumbnail=s[y].snippet.thumbnails.medium.url,a("#youmax-video-list-div").append((y+youmax_global_options.youmaxItemCount-n)%youmaxColumns!=0?'<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%;" id="'+playListId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+playlistThumbnail+"', sizingMethod='scale'); background-image:url('"+playlistThumbnail+'\')"><div class="youmax-playlist-sidebar" id="youmax-playlist-sidebar-'+playListId+'"><span class="youmax-playlist-video-count"><b>'+playlistSize+'</b><br/>VIDEOS</span></div></div><span class="youmax-video-list-title">'+playlistTitle+'</span><br/><span class="youmax-video-list-views">'+i(playlistUploaded)+" ago</span></div>":'<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%; clear:both;" id="'+playListId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+playlistThumbnail+"', sizingMethod='scale'); background-image:url('"+playlistThumbnail+'\')"><div class="youmax-playlist-sidebar" id="youmax-playlist-sidebar-'+playListId+'"><span class="youmax-playlist-video-count"><b>'+playlistSize+'</b><br/>VIDEOS</span></div></div><span class="youmax-video-list-title">'+playlistTitle+'</span><br/><span class="youmax-video-list-views">'+i(playlistUploaded)+" ago</span></div>"));youmax_global_options.youmaxItemCount+=s.length-n,a(".youmax-video-tnail-box").click(function(){d(),playlistTitle=a(this).find(".youmax-video-list-title").text(),v("play_"+this.id,playlistTitle)}),f()},x=function(o,e,l){console.log(o),l||(a("#youmax-video-list-div").empty(),e&&(a(".youmax-tab-hover").removeClass("youmax-tab-hover"),a("#youmax-video-list-div").append('<span class="youmax-showing-title youmax-tab-hover" id="uploads_'+o.items[0].snippet.playlistId+'" style="max-width:100%;"><span class="youmax-showing">&nbsp;&nbsp;Showing playlist: </span>'+e+"</span><br/>")));var t=o.nextPageToken,s=a("#youmax-load-more-div");youmaxColumns=youmax_global_options.youmaxColumns,null!=t&&"undefined"!=t&&""!=t?s.data("nextpagetoken",t):s.data("nextpagetoken","");for(var u=o.items,n=[],d=0;d<u.length;d++)videoId=u[d].snippet.resourceId.videoId,videoTitle=u[d].snippet.title,videoUploaded=u[d].snippet.publishedAt,videoThumbnail=u[d].snippet.thumbnails.medium.url,n.push(videoId),a("#youmax-video-list-div").append((d+youmax_global_options.youmaxItemCount)%youmaxColumns!=0?'<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%;" id="'+videoId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+videoThumbnail+"', sizingMethod='scale'); background-image:url('"+videoThumbnail+'\')"><div class="youmax-duration"></div></div><span class="youmax-video-list-title">'+videoTitle+'</span><br/><span class="youmax-video-list-views">'+i(videoUploaded)+" ago</span></div>":'<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%; clear:both;" id="'+videoId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+videoThumbnail+"', sizingMethod='scale'); background-image:url('"+videoThumbnail+'\')"><div class="youmax-duration"></div></div><span class="youmax-video-list-title">'+videoTitle+'</span><br/><span class="youmax-video-list-views">'+i(videoUploaded)+" ago</span></div>");youmax_global_options.youmaxItemCount+=u.length,a(".youmax-video-tnail-box").click(function(){youmax_global_options.showVideoInLightbox?h(this.id):(a("#youmax-video").attr("src","http://www.youtube.com/embed/"+this.id),a("#youmax-video").show(),a("html,body").animate({scrollTop:a("#youmax-header").offset().top},"slow"))}),b(n),f()},b=function(o){apiVideoStatURL=youmax_global_options.url+"/api/v1/widget/get/youtube/getFeed?call=video-stat&videoIdList="+o+"&sl="+youmax_global_options.sl,a.ajax({url:apiVideoStatURL,type:"GET",async:!0,cache:!0,dataType:"json",success:function(a){c(a)},error:function(a){alert(a)},beforeSend:n})},c=function(i){for(var l,t=i.items,s=0;s<t.length;s++)videoId=t[s].id,videoViewCount=t[s].statistics.viewCount,videoViewCount=e(videoViewCount),videoDuration=t[s].contentDetails.duration,videoDuration=o(videoDuration),videoDefinition=t[s].contentDetails.definition.toUpperCase(),l=a("#youmax-video-list-div #"+videoId),l.find(".youmax-video-list-views").prepend(videoViewCount+" views | "),l.find(".youmax-duration").append(videoDuration)},v=function(o,i,e){var l="",t=!1;null!=e&&(l="&pageToken="+e,t=!0);var s=o.substring(o.indexOf("_")+1),u=youmax_global_options.url+"/api/v1/widget/get/youtube/getFeed?call=upload&playlistId="+s+"&maxResults="+youmax_global_options.maxResults+"&sl="+youmax_global_options.sl;console.log("apiUploadURL-"+u),a.ajax({url:u,type:"GET",async:!0,cache:!0,dataType:"json",success:function(a){x(a,i,t)},error:function(a){alert(a)},beforeSend:n})},g=function(o){var i="",e=!1;null!=o&&(i="&pageToken="+o,e=!0);var l=youmax_global_options.url+"/api/v1/widget/get/youtube/getFeed?call=ChannelPlaylists&channelId="+youmaxChannelId+"&maxResults="+youmax_global_options.maxResults+"&sl="+youmax_global_options.sl;a.ajax({url:l,type:"GET",async:!0,cache:!0,dataType:"json",success:function(a){r(a,e)},error:function(a){alert(a)},beforeSend:n})},h=function(o){a("#youmax-lightbox").show(),a("#youmax-video-lightbox").attr("src","http://www.youtube.com/embed/"+o),a("#youmax-lightbox").click(function(){a("#youmax-video-lightbox").attr("src",""),a("#youmax-lightbox").hide()})},f=function(){var o=a("#youmax-load-more-div");o.removeClass("youmax-load-more-div-click"),o.text("LOAD MORE")},_=function(){a("#youmax").empty(),l(),d(),a(".youmax-tab").click(function(){a(".youmax-tab-hover").removeClass("youmax-tab-hover"),a(this).addClass("youmax-tab-hover"),youmaxTabId=this.id,d(),-1!=youmaxTabId.indexOf("featured_")?v("featured_"+youmax_global_options.youmaxFeaturedPlaylistId,null,null):-1!=youmaxTabId.indexOf("uploads_")?v(youmaxTabId):-1!=youmaxTabId.indexOf("playlists_")&&g()}),a("#youmax-load-more-div").click(function(){var o=a("#youmax-load-more-div");o.html("LOADING.."),o.addClass("youmax-load-more-div-click");var i=a(".youmax-tab-hover").attr("id"),e=o.data("nextpagetoken");console.log("load more clicked : nextPageToken-"+e),null!=e&&"undefined"!=e&&""!=e?-1!=i.indexOf("featured_")?v("featured_"+youmax_global_options.youmaxFeaturedPlaylistId,null,e):-1!=i.indexOf("uploads_")?v(i,null,e):"playlists_"==i&&g(e):o.html("ALL DONE")}),youTubeChannelURL=youmax_global_options.youTubeChannelURL,null!=youTubeChannelURL&&(s=youTubeChannelURL.indexOf("/user/"),-1!=s?(userId=youTubeChannelURL.substring(s+6),apiUrl=youmax_global_options.url+"/api/v1/widget/get/youtube/getFeed?call=id&forUsername="+userId+"&sl="+youmax_global_options.sl,t(apiUrl)):(s=youTubeChannelURL.indexOf("/channel/"),-1!=s?(youmaxChannelId=youTubeChannelURL.substring(s+9),youmax_global_options.youmaxChannelId=youmaxChannelId,u(youmaxChannelId)):alert("Could Not Find Channel..")))};a.fn.youmax=function(a){youmax_global_options.root=a.root,youmax_global_options.url=a.url,youmax_global_options.sl=a.sl,youmax_global_options.apiKey=a.apiKey,youmax_global_options.youTubeChannelURL=a.youTubeChannelURL||"",youmax_global_options.youTubePlaylistURL=a.youTubePlaylistURL||"",youmax_global_options.youmaxDefaultTab=a.youmaxDefaultTab||"FEATURED",youmax_global_options.youmaxColumns=a.youmaxColumns||3,youmax_global_options.showVideoInLightbox=a.showVideoInLightbox||!1,youmax_global_options.youmaxChannelId="",youmax_global_options.maxResults=a.maxResults||15,youmax_global_options.youmaxItemCount=0,youmax_global_options.youtubeVideoAspectRatio=640/360,youmax_global_options.youtubeMqdefaultAspectRatio=300/180,y(),_()}}(jQuery);